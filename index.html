<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"
      integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="sharedCSS.css" />
    <style>
      .lines {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 100%;
        margin: auto;
        width: 90vw;
      }

      .line {
        position: absolute;
        width: 1px;
        height: 100%;
        top: 0;
        left: 50%;
        background: rgba(255, 255, 255, 0.1);
        overflow: hidden;
      }

      .line::after {
        content: "";
        display: block;
        position: absolute;
        height: 15vh;
        width: 100%;
        top: -50%;
        left: 0;
        background: linear-gradient(
          to bottom,
          rgba(255, 255, 255, 0) 0%,
          #ffffff 75%,
          #ffffff 100%
        );
        animation: drop 7s 0s infinite;
        animation-fill-mode: forwards;
        animation-timing-function: cubic-bezier(0.4, 0.26, 0, 0.97);
      }

      .line:nth-child(1) {
        margin-left: -25%;
      }

      .line:nth-child(1)::after {
        animation-delay: 2s;
      }

      .line:nth-child(3) {
        margin-left: 25%;
      }

      .line:nth-child(3)::after {
        animation-delay: 2.5s;
      }

      @keyframes drop {
        0% {
          top: -50%;
        }
        100% {
          top: 110%;
        }
      }

      body {
        min-height: 100vh;
        width: 100%;
        display: flex;
        justify-content: center;
        background-color: #0d0d0d;
      }
      body::-webkit-scrollbar {
        display: none;
      }
      body::before,
      body::after {
        position: fixed;
        background: linear-gradient(
          to bottom,
          #0b0b1a,
          rgba(255, 255, 255, 0) 100%
        );
        content: "";
        height: 30%;
        width: 100%;
        z-index: 1;
      }

      body::before {
        top: 0;
      }
      body::after {
        bottom: 0;
        transform: rotate(180deg);
      }

      .search-container {
        margin-top: 200px;
        width: 95%;
        display: flex;
        align-items: center;
        flex-direction: column;
        gap: 50px;
        z-index: 2;
      }
      #searchInput {
        padding: 10px 20px;
        width: 80%;
        font-size: 16px;
        margin-bottom: 20px;
        border: 1px solid #0b0b1a;
        border-radius: 12px;
        outline: none;
      }
      .search-movie-card {
        width: 200px;
        height: 270px;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        opacity: 0;
        transform: translateY(20px);
        filter: blur(5px);
        transition: all 0.5s ease-out;
      }
      .search-movie-card.show {
        opacity: 1;
        transform: translateY(0);
        filter: blur(0);
      }
      .search-movie-card:hover img {
        transform: scale(1.1);
      }
      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        transition: 0.5s;
      }
      #search-results-container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 20px;
      }
      #search-no-results {
        display: none;
        font-size: 18px;
        color: #777;
        margin-top: 20px;
      }
      .typing {
        font-family: "Courier New", Courier, monospace;
        white-space: nowrap;
        color: #e8e8e8;
        font-size: 2rem;
        overflow: hidden;
        border-right: 2px solid #fff;
        animation: typing 2s steps(30, end), blink 0.5s step-end infinite;
      }
      @keyframes typing {
        from {
          width: 0;
        }
        to {
          width: 42.5%;
        }
      }
      @keyframes blink {
        50% {
          border-color: transparent;
        }
      }
      .slider-container {
        position: sticky;
        top: 0;
        left: 0;

        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
        z-index: 1;
        height: 100vh;
      }

      .slider {
        height: 100vh;
        width: 150px;
        overflow: hidden;
      }

      .slider-track {
        display: flex;
        flex-direction: column;
        animation: scroll 40s linear infinite;
        gap: 10px;
      }

      .slider-track.reverse {
        animation-direction: reverse;
      }

      @keyframes scroll {
        0% {
          transform: translateY(0);
        }
        100% {
          transform: translateY(calc(-200px * 6));
        }
      }

      .slider-track:hover {
        animation-play-state: paused;
      }

      .slide {
        height: 200px;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-sizing: border-box;
        overflow: hidden;
        border-radius: 8px;
        border: 1px solid #5858cc;
      }

      img {
        width: 100%;
        object-fit: cover;
        object-position: center;
        height: 100%;
        border-radius: 8px;
      }
      .overlay {
        position: fixed;
        height: 100vh;
        width: 100%;
        background: #0d0d0dbc;
        z-index: 1;
        /* backdrop-filter: blur(10px); */
      }

      @media only screen and (max-width: 768px) {
        .slider-container {
          position: absolute;
          width: 100%;
          pointer-events: none;
        }
        .typing {
          font-size: 1.6rem;
          animation: typing 1s steps(20, end), blink 0.5s step-end infinite;
        }
        #searchInput {
          width: 95%;
          font-size: 16px;
          margin-bottom: 20px;
          border-radius: 50px;
        }
        .search-movie-card {
          width: 140px;
          height: 190px;
        }
      }
    </style>
  </head>
  <body>
    <div class="lines">
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
    </div>
    <div class="slider-container">
      <div class="slider">
        <div class="slider-track">
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/dfF6LZ8JtBoqIXMzDvBE3ggY7jY.jpg"
              alt="Image 1"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/oDYvDCcTbIc6FzaGImWUb6nZGIp.jpg"
              alt="Image 2"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/zQc1PITqFxZDbEmHlQgO5Mxc4Od.jpg"
              alt="Image 3"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/k7bclFV4hWIdgNcLileBKGWFIa9.jpg"
              alt="Image 4"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/wIGJnIFQlESkC2rLpfA8EDHqk4g.jpg"
              alt="Image 5"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/58QT4cPJ2u2TqWZkterDq9q4yxQ.jpg"
              alt="Image 6"
            />
          </div>

          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/dfF6LZ8JtBoqIXMzDvBE3ggY7jY.jpg"
              alt="Image 1"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/oDYvDCcTbIc6FzaGImWUb6nZGIp.jpg"
              alt="Image 2"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/zQc1PITqFxZDbEmHlQgO5Mxc4Od.jpg"
              alt="Image 3"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/k7bclFV4hWIdgNcLileBKGWFIa9.jpg"
              alt="Image 4"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/wIGJnIFQlESkC2rLpfA8EDHqk4g.jpg"
              alt="Image 5"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/58QT4cPJ2u2TqWZkterDq9q4yxQ.jpg"
              alt="Image 6"
            />
          </div>
        </div>
      </div>

      <div class="slider">
        <div class="slider-track reverse">
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/ineLOBPG8AZsluYwnkMpHRyu7L.jpg"
              alt="Image 1"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/zO5xURaYgMX6WpXolp83zVk03Yh.jpg"
              alt="Image 2"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/g4CzzEmiNrGGeR4yv1CQtNGxFBs.jpg"
              alt="Image 3"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/1NxaSn4ver4jIvLeD7YF8cTlZjB.jpg"
              alt="Image 4"
            />
          </div>
          <div class="slide">
            <img
              src="https://m.media-amazon.com/images/I/41nK6uN99xL._SL500_.jpg"
              alt="Image 5"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/pnrv8tfOcWxu4CrB8N7xK0jYJsR.jpg"
              alt="Image 6"
            />
          </div>

          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/ineLOBPG8AZsluYwnkMpHRyu7L.jpg"
              alt="Image 1"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/zO5xURaYgMX6WpXolp83zVk03Yh.jpg"
              alt="Image 2"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/g4CzzEmiNrGGeR4yv1CQtNGxFBs.jpg"
              alt="Image 3"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/1NxaSn4ver4jIvLeD7YF8cTlZjB.jpg"
              alt="Image 4"
            />
          </div>
          <div class="slide">
            <img
              src="https://m.media-amazon.com/images/I/41nK6uN99xL._SL500_.jpg"
              alt="Image 5"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/pnrv8tfOcWxu4CrB8N7xK0jYJsR.jpg"
              alt="Image 6"
            />
          </div>
        </div>
      </div>

      <div class="slider">
        <div class="slider-track">
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/ooikdDNDOHS8hCURplWeTW7FzHJ.jpg"
              alt="Image 1"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/iuRJ2QRRNMIu2VdEIuLIaJvt1PZ.jpg"
              alt="Image 2"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/8RtwL5gxUvh9YViqjhNlVRvJpum.jpg"
              alt="Image 3"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/iljKqptaX37Rr4B5z3ubo45HhhD.jpg"
              alt="Image 4"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/3N0xWUDlR5Nq4zV7w69hfCWMbJO.jpg"
              alt="Image 5"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/ha0SrDi69IIlb8Q9oJIZt8biVWr.jpg"
              alt="Image 6"
            />
          </div>

          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/ooikdDNDOHS8hCURplWeTW7FzHJ.jpg"
              alt="Image 1"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/iuRJ2QRRNMIu2VdEIuLIaJvt1PZ.jpg"
              alt="Image 2"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/8RtwL5gxUvh9YViqjhNlVRvJpum.jpg"
              alt="Image 3"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/iljKqptaX37Rr4B5z3ubo45HhhD.jpg"
              alt="Image 4"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/3N0xWUDlR5Nq4zV7w69hfCWMbJO.jpg"
              alt="Image 5"
            />
          </div>
          <div class="slide">
            <img
              src="https://image.tmdb.org/t/p/w500/ha0SrDi69IIlb8Q9oJIZt8biVWr.jpg"
              alt="Image 6"
            />
          </div>
        </div>
      </div>
    </div>
    <div class="overlay"></div>
    <div class="modal">
      <i
        id="closeModal"
        style="
          position: absolute;
          left: 0;
          top: 0;
          color: whitesmoke;
          padding: 20px;
          font-size: 2rem;
        "
        class="fa-solid fa-arrow-left-long"
      ></i>
      <div class="posterContainer">
        <img id="modalPoster" src="" />
      </div>
      <div class="informationContainer">
        <div class="titleContainer">
          <div
            style="
              width: calc(100% - 120px);
              display: flex;
              justify-content: center;
              flex-direction: column;
              gap: 10px;
              padding: 10px;
            "
          >
            <h1 id="modalTitle"></h1>
            <div style="display: flex; padding: 10px">
              <p id="countryOriginContainer">Year</p>
              &nbsp; | &nbsp;
              <p id="yearReleasedContainer"></p>
              &nbsp; | &nbsp;
              <p style="text-transform: uppercase" id="MediaTypeContainer"></p>
            </div>
          </div>
          <div id="progressBarRating"></div>
        </div>
        <div class="buttonsContainer">
          <button id="buttonOverview">Overview</button>
          <button id="buttonEpisodes" style="display: none">Episodes</button>
          <button id="buttonTrailer">Trailers</button>
          <button>Images</button>
        </div>
        <div class="overviewContainer"></div>
      </div>
    </div>
    <header>
      <div class="brandLogoContainer">
        <img
          style="filter: drop-shadow(0 0 1px rgb(33, 33, 33))"
          src="https://i.ibb.co/n0c3gXW/1.png"
        />
        <h1>[STREAM]</h1>
      </div>

      <nav>
        <a href="/home.html" class="home">
          <div class="sidebar-logo">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-home"
            >
              <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
              <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
          </div>
          <p>Home</p>
        </a>
        <a href="/movie.html" class="movies">
          <div class="sidebar-logo">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-clapperboard"
            >
              <path
                d="M20.2 6 3 11l-.9-2.4c-.3-1.1.3-2.2 1.3-2.5l13.5-4c1.1-.3 2.2.3 2.5 1.3Z"
              ></path>
              <path d="m6.2 5.3 3.1 3.9"></path>
              <path d="m12.4 3.4 3.1 4"></path>
              <path d="M3 11h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Z"></path>
            </svg>
          </div>
          <p>Movies</p>
        </a>
        <a href="/tv.html" class="tvSeries">
          <div class="sidebar-logo">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-tv"
            >
              <rect width="20" height="15" x="2" y="7" rx="2" ry="2"></rect>
              <polyline points="17 2 12 7 7 2"></polyline>
            </svg>
          </div>
          <p>Series</p>
        </a>
        <div style="color: red" class="searchFunction">
          <div class="sidebar-logo">
            <svg
              stroke="currentColor"
              fill="currentColor"
              stroke-width="0"
              viewBox="0 0 24 24"
              class="style_inactive__EPRfk"
              height="24"
              width="24"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11 2C15.968 2 20 6.032 20 11C20 15.968 15.968 20 11 20C6.032 20 2 15.968 2 11C2 6.032 6.032 2 11 2ZM11 18C14.8675 18 18 14.8675 18 11C18 7.1325 14.8675 4 11 4C7.1325 4 4 7.1325 4 11C4 14.8675 7.1325 18 11 18ZM19.4853 18.0711L22.3137 20.8995L20.8995 22.3137L18.0711 19.4853L19.4853 18.0711Z"
              ></path>
            </svg>
          </div>
          <p>Search</p>
        </div>
      </nav>
    </header>
    <div class="search-container">
      <h1 class="typing">WHAT ARE YOU WATCHING TODAY?</h1>
      <input
        type="text"
        id="searchInput"
        placeholder="Search your favorite show ..."
      />
      <div id="search-results-container"></div>
      <div id="search-no-results">No results found.</div>
    </div>
    <script src="/apikey.js"></script>

    <script src="/FETCHSHOW.js"></script>
    <script src="/FETCHIMAGES.js"></script>

    <script src="/LAZYLOAD.js"></script>

    <script src="/MODAL.js"></script>

    <script>
      const searchInput = document.getElementById("searchInput");
      const resultsContainer = document.getElementById(
        "search-results-container"
      );
      const noResults = document.getElementById("search-no-results");

      let currentPage = 1; // Track current page
      let currentQuery = ""; // Track current query
      let isFetching = false; // Prevent multiple simultaneous fetches

      const searchFetchMovies = async (query, page = 1) => {
        const response = await fetch(
          `https://api.themoviedb.org/3/search/multi?api_key=${apiKey}&query=${query}&language=en-US&page=${page}`
        );
        const data = await response.json();
        return data.results.filter(
          (movie) => movie.poster_path && movie.vote_average > 0
        );
      };

      const searchDisplayMovies = (movies) => {
        if (movies.length === 0 && currentPage === 1) {
          noResults.style.display = "block";
          return;
        } else {
          noResults.style.display = "none";
        }

        movies.forEach((movie, index) => {
          const movieCard = document.createElement("div");
          movieCard.classList.add("search-movie-card");
          const movieImageBackdrop = `https://image.tmdb.org/t/p/w1280${movie.backdrop_path}`;
          const movieImage = `https://image.tmdb.org/t/p/w1280${movie.poster_path}`;
          movieCard.innerHTML = `
          <img src="${movieImage}" alt="${movie.title || movie.name}" />
        `;

          resultsContainer.appendChild(movieCard);

          movieCard.addEventListener("click", () => {
            modal(
              movie.id,
              movie.overview,
              movieImageBackdrop,
              movieImage,
              movie.name || movie.title,
              movie.media_type,
              movie.vote_average,
              movie.release_date || movie.first_air_date,
              movie.original_language
            );
          });

          setTimeout(() => {
            movieCard.classList.add("show");
          }, index * 100);
        });
      };

      const loadMoreMovies = async () => {
        if (!currentQuery || isFetching) return;

        isFetching = true;
        currentPage++;
        const movies = await searchFetchMovies(currentQuery, currentPage);
        searchDisplayMovies(movies);
        isFetching = false;
      };

      const handleScroll = () => {
        const { scrollTop, scrollHeight, clientHeight } =
          document.documentElement;
        if (scrollTop + clientHeight >= scrollHeight - 10) {
          loadMoreMovies();
        }
      };

      searchInput.addEventListener("input", async (event) => {
        currentQuery = event.target.value;
        currentPage = 1;
        resultsContainer.innerHTML = "";

        if (currentQuery.length >= 1) {
          const movies = await searchFetchMovies(currentQuery, currentPage);
          searchDisplayMovies(movies);
        } else {
          noResults.style.display = "none";
        }
      });

      window.addEventListener("scroll", handleScroll);
    </script>
  </body>
</html>
